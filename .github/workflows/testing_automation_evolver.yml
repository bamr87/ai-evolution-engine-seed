name: AI Evolution - Testing & Build Automation

on:
  workflow_dispatch:
    inputs:
      growth_mode:
        description: 'Growth mode for evolution'
        required: true
        default: 'test-automation'
        type: choice
        options:
          - test-automation
          - build-optimization
          - error-resilience
          - ci-cd-enhancement
      
jobs:
  evolve:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Setup environment
      run: ./scripts/setup-environment.sh
        
    - name: Generate evolution seed
      run: |
        ./scripts/generate_seed.sh \
          --cycle 3 \
          --generation 1 \
          --prompt "Enhanced testing and build automation with error resolution patterns from zer0-mistakes Jekyll theme" \
          --growth-mode ${{ github.event.inputs.growth_mode }}
          
    - name: Generate AI response
      run: |
        ./scripts/generate_ai_response.sh \
          --cycle 3 \
          --generation 1 \
          --growth-mode ${{ github.event.inputs.growth_mode }}
          
    - name: Create evolution PR
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        ./scripts/create_pr.sh \
          --cycle 3 \
          --generation 1 \
          --growth-mode ${{ github.event.inputs.growth_mode }}
          
    - name: Test evolved seed
      run: ./scripts/test-evolved-seed.sh ${{ github.event.inputs.growth_mode }}
